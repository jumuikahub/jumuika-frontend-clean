#!/bin/sh
# Husky v10-safe pre-push hook with Jest + test file guard

echo "âœ… Running tests before push..."

# Check if Jest is installed
if ! command -v jest >/dev/null 2>&1; then
  echo "âš ï¸  Jest not found. Skipping tests."
  exit 0
fi

# Look for test files
if git ls-files | grep -E '\.test\.(js|jsx|ts|tsx)$' > /dev/null; then
  echo "ğŸ” Test files found, running npm test..."
  if npm test; then
    echo "âœ… Tests passed. Proceeding with push."
    exit 0
  else
    echo "âŒ Tests failed. Push aborted."
    exit 1
  fi
else
  echo "âš ï¸  No test files found. Skipping tests."
  exit 0
fi
